# 2019年05月07日21:20:05

晚上七点半开始一直在建图

到现在才上来



昨天来到嘉定, 为里程计的事情做实验

左转的结果, 右转的结果

比五一假前要偏了好多

里程计突然不准了, 奇了怪了

做实验, 分析数据

用imu数据做对比, 同时在跑圈的时候还用了里程计

发现右转的时候, 待转到最大转角

收到的角速度比imu的角速度要大一些

左转的时候, 有时准确, 有时不准

最终导致在某些关键转弯点, 或是转过大, 或是没转过去

整个里程计无法使用



今天在会上和硬件组的同事们讨论了里程计的问题

他们给出的结论大致如下

驾驶脑控制底盘转向发1和2

待前轮转到某一角度, 收到2消息, 卸力

前轮会出现抖动

0度转到20度, 保持, 抖动, 现在真实值会是19度

但是发上来的消息依然是20度

现在驾驶脑要求转到5度的地方, 于是舵机右转15度

最终转到真实值是4度的地方

误差依次累加, 最终gg

解决方案, 暂时使用imu的角速度, 代替我们模型计算的角速度

等待新的功能机或是样机的出现



今晚把车开到一楼建图

一楼要比四楼复杂得多

自己一个人在下面建图

建了四圈, 一个不如一个

找不到原因

发现 `rosservice call /write_state ~/map.pbstream` 这样写 pbstream 的指令

只能在运行 mapping.launch 的机子上使用

如: 我在工控机上面开的mapping.launch

那么我只能在工控机上保存pbstream, 而在我自己的电脑(从机)上保存pbstream会报错

另外需要注意, 保存pbstream比之前多了一个bool类型的参数